{% extends "base.html" %}
{% block title %}Toutes les commandes{% endblock %}

{% block content %}
<h2>Commandes des clients</h2>
<table style="width:100%;border-collapse:collapse;">
    <thead>
        <tr>
            <th style="border:1px solid #ccc;padding:6px;">Nom</th>
            <th style="border:1px solid #ccc;padding:6px;">Prénom</th>
            <th style="border:1px solid #ccc;padding:6px;">Email</th>
            <th style="border:1px solid #ccc;padding:6px;">Adresse</th>
            <th style="border:1px solid #ccc;padding:6px;">Téléphone</th>
            <th style="border:1px solid #ccc;padding:6px;">Produit</th>
            <th style="border:1px solid #ccc;padding:6px;">Quantité</th>
            <th style="border:1px solid #ccc;padding:6px;">Total (€)</th>
            <th style="border:1px solid #ccc;padding:6px;">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for cmd in commandes %}
        <tr>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[2] }}</td>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[3] }}</td>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[4] }}</td>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[5] }}</td>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[6] }}</td>
            <td style="border:1px solid #ccc;padding:6px;">{{ cmd[7] }}</td>
            <td style="border:1px solid #ccc;padding:6px;text-align:center;">{{ cmd[8] }}</td>
            <td style="border:1px solid #ccc;padding:6px;text-align:right;">{{ cmd[9] }}</td>
            <td style="border:1px solid #ccc;padding:6px;text-align:center;">
                <button onclick="confirmDelete({{ cmd[0] }})" style="color:red;background:none;border:none;cursor:pointer;">Supprimer</button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Modal de confirmation -->
<div id="deleteModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
    <div style="background:white;padding:20px;border-radius:8px;max-width:400px;text-align:center;">
        <p>Voulez-vous vraiment supprimer cette commande ?</p>
        <button id="confirmBtn" style="padding:6px 12px;background:red;color:white;border:none;border-radius:4px;">Oui, supprimer</button>
        <button onclick="closeModal()" style="padding:6px 12px;background:#ccc;color:black;border:none;border-radius:4px;margin-left:10px;">Annuler</button>
    </div>
</div>

<script>
let deleteId = null;

function confirmDelete(commandeId) {
    deleteId = commandeId;
    document.getElementById('deleteModal').style.display = 'flex';
}

function closeModal() {
    deleteId = null;
    document.getElementById('deleteModal').style.display = 'none';
}

document.getElementById('confirmBtn').addEventListener('click', function() {
    if(deleteId) {
        window.location.href = "/delete_order/" + deleteId;
    }
});
</script>
{% endblock %}
